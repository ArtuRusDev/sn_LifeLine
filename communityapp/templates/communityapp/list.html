{% extends 'mainapp/base.html' %}
{% load static %}
{% block title %}Life on Line | Сообщества{% endblock %}
{% block content %}
    <div class="container content">
        <div class="news_block">
            <h2 class="text-center">Все сообщества</h2>

            <div class="communities_list">
                {% for community in communities %}
                    <div class="friend_item d-flex justify-content-between" data-community_id="{{ community.id }}">
                        <div class="friend_item_title w-100">
                            <img src="/media/{{ community.image|default:'users_avatars/default.png' }}"
                                 alt="Аватарка" class="user_avatar_friends">

                            <div class="friend_item_title-username">
                                <a href="{% url 'community:detail' community.pk %}">
                                    {{ community.name }}
                                </a>
                            </div>
                            <div>
                                {{ community.description }}
                            </div>
                        </div>

                        {% if community.creator.id != user.pk %}
                            {% if community.pk in subscribed_communities_id %}
                                <button onclick="subscribe_community({{ community.pk }})" class="btn btn-danger mr-1">
                                    Покинуть
                                </button>
                            {% else %}
                                <button onclick="subscribe_community({{ community.pk }})" class="btn btn-success mr-1">
                                    Вступить
                                </button>
                            {% endif %}
                        {% else %}
                            <button class="btn btn-secondary disabled mr-1">
                                Владелец
                            </button>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>

            {% if not object_list %}
                <p>Еще нет ни одного сообщества</p>
            {% endif %}

            <p class="mt-3">
                <a href="{% url 'community:create' %}" class="btn btn-success">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                    Создать сообщество
                </a>
            </p>
        </div>
    </div>
{% endblock %}